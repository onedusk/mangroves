{
  "id": "2",
  "task": "Write comprehensive tenant isolation tests",
  "entry": "2025-10-17",
  "modified": "2025-10-17",
  "priority": "H",
  "project": "mangroves-multi-tenant",
  "status": "completed",
  "uuid": "b2c3d4e5-f6g7-4890-b1c2-d3e4f5g6h7i8",
  "urgency": "10",
  "subtasks": [
    "Create spec/models/concerns/tenant_scoped_spec.rb for testing TenantScoped concern behavior",
    "Write test 'scopes queries to Current.account when set' using two accounts and verifying cross-tenant isolation",
    "Write test 'auto-assigns Current.account to new records on create' verifying account_id is automatically set",
    "Write test 'raises error when creating record without Current.account set' to catch missing tenant context",
    "Write test 'unscoped_all bypasses tenant scoping' for admin access scenarios requiring cross-tenant queries",
    "Add shared_examples 'tenant scoped model' in spec/support/shared_examples/tenant_scoped.rb for reuse across models",
    "Update spec/models/workspace_spec.rb to include_examples 'tenant scoped model' and write WorkspaceMembership/TeamMembership validation specs rejecting cross-tenant users",
    "Run 'bundle exec rspec spec/models/concerns/tenant_scoped_spec.rb' and verify all tenant isolation tests pass"
  ],
  "must_reference": [
    "mangroves/docs/rails_conventions.md"
  ]
}